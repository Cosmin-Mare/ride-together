# Ride Together

An intuitive open-source app for carpooling with your friends.

---

## üõ†Ô∏è Local development ‚Äî run & build

### Prerequisites
- **Flutter** (stable) installed and on your PATH ‚Äî https://flutter.dev/docs/get-started/install
- **Android Studio** (for Android) or **Xcode** (for iOS/macOS) if you want to run on simulators/emulators or build platform releases
- **CocoaPods** for iOS/macOS: `sudo gem install cocoapods` (or use Homebrew)
- **node.js & npm** (for `functions/` local dev)
- (Optional) **Firebase CLI** if you want to use the emulator: `npm install -g firebase-tools`

### Get the code

```bash
git clone <repo-url>
cd ride_together
```

### Install deps

```bash
# Dart/Flutter packages
flutter pub get

# Functions (Cloud Functions)
cd functions && npm install && cd ..

# iOS/macOS pods (macOS)
cd ios && pod install && cd ..
```

### Run on device / emulator

Mapbox requires an access token (see "Secrets & keys" below). You must pass it at build/run time with `--dart-define`.

Run on Android emulator:

```bash
flutter run -d emulator-5554 --dart-define=ACCESS_TOKEN=sk.your_mapbox_token_here
```

Run on iOS simulator (macOS/Xcode):

```bash
flutter run -d <device-id> --dart-define=ACCESS_TOKEN=sk.your_mapbox_token_here
```

Run on macOS desktop:

```bash
flutter run -d macos --dart-define=ACCESS_TOKEN=sk.your_mapbox_token_here
```

### Build release artifacts

```bash
flutter build apk --release --dart-define=ACCESS_TOKEN=sk.your_mapbox_token_here
flutter build ios --release --dart-define=ACCESS_TOKEN=sk.your_mapbox_token_here
```

---

## üîê Secrets & environment keys

This project uses the following external keys:

- **Mapbox ACCESS_TOKEN** ‚Äî used for routing and map tiles
- **Firebase config** ‚Äî `google-services.json` (Android) and `GoogleService-Info.plist` (iOS/macOS). The `lib/firebase_options.dart` file is generated by the FlutterFire CLI and may contain project-specific values.

Important: Do **not** commit your own secret keys to public repos. Use local-only configuration or CI secrets.

How to get and set the keys:

1. Mapbox access token
   - Create an account at https://www.mapbox.com/ and create an access token.
   - Provide it when running or building Flutter with:
     ```bash
     flutter run --dart-define=ACCESS_TOKEN=sk.YOUR_TOKEN
     # or
     flutter build apk --dart-define=ACCESS_TOKEN=sk.YOUR_TOKEN
     ```
   - In VS Code you can also add the dart-define to your launch config, e.g. in `.vscode/launch.json` add:
     ```json
     "args": ["--dart-define=ACCESS_TOKEN=sk.YOUR_TOKEN"]
     ```

2. Firebase config
   - Open the Firebase console for the project and download the platform config files:
     - **Android**: `google-services.json` ‚Üí place into `android/app/`
     - **iOS/macOS**: `GoogleService-Info.plist` ‚Üí place into `ios/Runner/` and `macos/Runner/` if needed
   - If you want to use your own Firebase project, install the FlutterFire CLI and (re)configure:
     ```bash
     dart pub global activate flutterfire_cli
     flutterfire configure
     ```
   - The repo already includes `lib/firebase_options.dart` and platform files; if you switch projects, regenerate/replace them.

3. Google Maps / Places API
   - This app uses the **Places Autocomplete** and **Geocoding** APIs in:
     - `lib/widgets/location_search_bar.dart` (Places autocomplete & place details)
     - `lib/request_ride_page.dart` (reverse geocoding / geocode lookups)
   - Create an API key in the Google Cloud Console: https://console.cloud.google.com/apis/credentials
     - Enable the **Places API** and **Geocoding API** (and Maps SDKs if needed).
     - **Restrict** the key to only the required APIs and to your app (Android package name + SHA-1, iOS bundle id, or HTTP referrers).
   - How to provide the key locally (recommended):
     ```bash
     flutter run --dart-define=GOOGLE_API_KEY=YOUR_GOOGLE_API_KEY
     flutter build apk --dart-define=GOOGLE_API_KEY=YOUR_GOOGLE_API_KEY
     ```
     The code reads the key with `String.fromEnvironment('GOOGLE_API_KEY')`.
   - Alternative platform-specific places:
     - Android: add `meta-data` in `AndroidManifest.xml` or include the key in `google-services.json` resources (but be careful not to commit a production-only key).
     - iOS/macOS: add key to `AppDelegate` or Info.plist as described in Google Maps docs.
   - Security: do **not** commit API keys. Use local env, `.env` files (gitignored), or CI secret stores for production.

4. Other secrets (if you add new APIs)
   - Prefer passing keys with `--dart-define` or use platform-specific secret storage.
   - Never store production secrets in source control. Use environment- or CI-level secret management.

---

## üß≠ Opening the platform SDKs / IDE tips

- Open the Android project in Android Studio: `Open` ‚Üí select the `android/` folder. Let Gradle sync.
- Open the iOS project in Xcode (always use the workspace):
  ```bash
  open ios/Runner.xcworkspace
  ```
- Open `functions/` in your editor to view Cloud Functions sources (`functions/index.js`).
- To run Cloud Functions locally using the Firebase emulator:
  ```bash
  cd functions
  firebase emulators:start --only functions
  ```

---

## ‚úÖ Quick checklist

- [ ] Flutter installed and running (`flutter doctor`)
- [ ] `flutter pub get` succeeded
- [ ] Mapbox `ACCESS_TOKEN` set via `--dart-define`
- [ ] Platform Firebase files present (or `flutterfire configure` run)

---

## üí¨ Troubleshooting tips

- If Mapbox routes fail, ensure `ACCESS_TOKEN` is passed and valid. The code reads it with `String.fromEnvironment('ACCESS_TOKEN')` in `lib/main.dart` and sets it using `MapboxOptions.setAccessToken(...)`.
- If iOS build fails after changing pods: run `cd ios && pod install --repo-update`.
- If you need to update Firebase setup, run `flutterfire configure` and re-run `flutter pub get`.

---

If you want, I can also add a short `.env` example or a safe VS Code launch config snippet to this README. Want me to add that? ‚ú®
